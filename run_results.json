{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.4", "generated_at": "2025-07-25T17:28:33.590161Z", "invocation_id": "e9b8949b-f576-435d-93aa-119343561f4c", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.482067Z", "completed_at": "2025-07-25T17:28:33.494098Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.494663Z", "completed_at": "2025-07-25T17:28:33.494680Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01489710807800293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.TrailerMarket.stg_fact_vehicles", "compiled": true, "compiled_code": "with raw as (\n    select\n        vehicle_id,\n        mark_id,\n        model_id,\n        category_id,\n        body_id,\n        city_id,\n        state_id,\n        -- dealer_id \u043f\u0435\u0440\u0435\u0432\u043e\u0434\u0438\u043c\u043e \u0432 dealer_type\n        case\n            when dealer_id = 0 then 'unknown'\n            when dealer_id = 1 then 'private'\n            when dealer_id = 2 then 'company'\n            else 'unknown'\n        end as dealer_type,\n        year,\n        price_eur,\n        price_usd,\n        price_uah,\n        -- mileage_km: null \u0437\u0430\u043c\u0456\u043d\u044f\u0454\u043c\u043e \u043d\u0430 -1\n        coalesce(mileage_km, -1) as mileage_km,\n        currency_code,\n        -- \u0437\u0430\u043b\u0438\u0448\u0430\u0454\u043c\u043e null \u0443 \u0434\u0430\u0442\u0430\u0445 added_at, expired_at\n        added_at,\n        expired_at,\n        country_code\n    from \"postgres\".\"public\".\"factvehicles_new\"\n)\n\nselect * from raw", "relation_name": "\"postgres\".\"public\".\"stg_fact_vehicles\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.496875Z", "completed_at": "2025-07-25T17:28:33.501055Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.501794Z", "completed_at": "2025-07-25T17:28:33.501814Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006022453308105469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.TrailerMarket.stg_factvehicles_comparison", "compiled": true, "compiled_code": "select\n    vehicle_id,\n    mark_id,\n    model_id,\n    category_id,\n    body_id,\n    dealer_id,\n    year,\n    price_eur,\n    price_usd,\n    price_uah,\n    coalesce(mileage_km, -1) as mileage_km,  -- \u0437\u0430\u043c\u0456\u043d\u0438\u043b\u0438 null \u043d\u0430 -1\n    currency_code,\n    added_at,\n    expired_at,\n    country_code\nfrom \"postgres\".\"public\".\"factvehicles_comparison\"", "relation_name": "\"postgres\".\"public\".\"stg_factvehicles_comparison\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.505444Z", "completed_at": "2025-07-25T17:28:33.521488Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.522374Z", "completed_at": "2025-07-25T17:28:33.522386Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01880812644958496, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.TrailerMarket.not_null_stg_fact_vehicles_vehicle_id.55b8c41e23", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect vehicle_id\nfrom \"postgres\".\"public\".\"stg_fact_vehicles\"\nwhere vehicle_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.525995Z", "completed_at": "2025-07-25T17:28:33.538211Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.538833Z", "completed_at": "2025-07-25T17:28:33.538843Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014373302459716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.TrailerMarket.unique_stg_fact_vehicles_vehicle_id.b371a6f0a6", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    vehicle_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_fact_vehicles\"\nwhere vehicle_id is not null\ngroup by vehicle_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.540813Z", "completed_at": "2025-07-25T17:28:33.546898Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.547495Z", "completed_at": "2025-07-25T17:28:33.547506Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007606983184814453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.TrailerMarket.fact_vehicles_silver", "compiled": true, "compiled_code": "\n\nwith source_1 as (\n    select\n        vehicle_id,\n        mark_id,\n        model_id,\n        category_id,\n        body_id,\n        city_id,\n        state_id,\n        mileage_km,\n        added_at,\n        expired_at,\n        year,\n        price_eur,\n        price_usd,\n        price_uah,\n        null::integer as dealer_id,         -- \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u043c \u043a integer\n        country_code,\n        currency_code\n    from \"postgres\".\"public\".\"stg_fact_vehicles\"\n),\n\nsource_2 as (\n    select\n        vehicle_id,\n        mark_id,\n        model_id,\n        category_id,\n        body_id,\n        null::integer as city_id,           -- \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u043c \u043a integer\n        null::integer as state_id,          -- \u043f\u0440\u0438\u0432\u043e\u0434\u0438\u043c \u043a integer\n        mileage_km,\n        added_at,\n        expired_at,\n        year,\n        price_eur,\n        price_usd,\n        price_uah,\n        dealer_id,\n        country_code,\n        currency_code\n    from \"postgres\".\"public\".\"stg_factvehicles_comparison\"\n)\n\nselect * from source_1\nunion all\nselect * from source_2", "relation_name": "\"postgres\".\"public\".\"fact_vehicles_silver\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.549456Z", "completed_at": "2025-07-25T17:28:33.562487Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.563165Z", "completed_at": "2025-07-25T17:28:33.563175Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01465463638305664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.TrailerMarket.not_null_stg_factvehicles_comparison_vehicle_id.7156f3ba5c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect vehicle_id\nfrom \"postgres\".\"public\".\"stg_factvehicles_comparison\"\nwhere vehicle_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.565323Z", "completed_at": "2025-07-25T17:28:33.574670Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.575691Z", "completed_at": "2025-07-25T17:28:33.575707Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011499643325805664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.TrailerMarket.unique_stg_factvehicles_comparison_vehicle_id.f472c76caa", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    vehicle_id as unique_field,\n    count(*) as n_records\n\nfrom \"postgres\".\"public\".\"stg_factvehicles_comparison\"\nwhere vehicle_id is not null\ngroup by vehicle_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-07-25T17:28:33.578449Z", "completed_at": "2025-07-25T17:28:33.586627Z"}, {"name": "execute", "started_at": "2025-07-25T17:28:33.587262Z", "completed_at": "2025-07-25T17:28:33.587274Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009833335876464844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.TrailerMarket.fact_vehicles_gold", "compiled": true, "compiled_code": "\n\nselect\n    f.vehicle_id,\n    f.mileage_km,\n    f.added_at,\n    f.expired_at,\n    f.year,\n    f.price_eur,\n    f.price_usd,\n    f.price_uah,\n    f.dealer_id,\n\n    c.name as country_name,\n    cur.\"currencyName\" as currency_name,\n    b.name as body_style_name,\n    cat.category_name,\n    city.name as city_name,\n    mark.name as mark_name,\n    model.name as model_name,\n    state.name as state_name\n\nfrom \"postgres\".\"public\".\"fact_vehicles_silver\" f\n\nleft join \"postgres\".\"public\".\"DimCountries\" c\n    on f.country_code::int = c.value\n\nleft join \"postgres\".\"public\".\"DimCurrency\" cur\n    on f.currency_code = cur.\"currencyCode\"\n\nleft join \"postgres\".\"public\".\"dim_body_styles\" b\n    on f.body_id = b.bodystyle_id\n\nleft join \"postgres\".\"public\".\"dim_categories\" cat\n    on f.category_id = cat.category_value\n\nleft join \"postgres\".\"public\".\"dim_cities\" city\n    on f.city_id = city.value\n\nleft join \"postgres\".\"public\".\"dim_marks\" mark\n    on f.mark_id = mark.value\n\nleft join \"postgres\".\"public\".\"dim_models\" model\n    on f.model_id = model.value\n\nleft join \"postgres\".\"public\".\"dim_states\" state\n    on f.state_id = state.value", "relation_name": "\"postgres\".\"public\".\"fact_vehicles_gold\"", "batch_results": null}], "elapsed_time": 2.213033437728882, "args": {"require_batched_execution_for_custom_microbatch_strategy": false, "state_modified_compare_vars": false, "introspect": true, "require_resource_names_without_spaces": false, "print": true, "favor_state": false, "vars": {}, "exclude": [], "which": "generate", "static": false, "cache_selected_only": false, "indirect_selection": "eager", "require_nested_cumulative_type_params": false, "invocation_command": "dbt docs generate", "use_colors": true, "log_level": "info", "select": [], "state_modified_compare_more_unrendered_values": false, "version_check": true, "write_json": true, "compile": true, "partial_parse_file_diff": true, "quiet": false, "send_anonymous_usage_stats": true, "strict_mode": false, "warn_error_options": {"include": [], "exclude": []}, "log_level_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "log_file_max_bytes": 10485760, "macro_debugging": false, "project_dir": "C:\\Users\\anna.fedotova\\.dbt\\final_project_data-eng\\TrailerMarket", "defer": false, "static_parser": true, "profiles_dir": "C:\\Users\\anna.fedotova\\.dbt", "empty_catalog": false, "require_explicit_package_overrides_for_builtin_materializations": true, "show_resource_report": false, "log_path": "C:\\Users\\anna.fedotova\\.dbt\\final_project_data-eng\\TrailerMarket\\logs", "partial_parse": true, "use_colors_file": true, "printer_width": 80, "log_format": "default", "log_format_file": "debug", "populate_cache": true, "source_freshness_run_project_hooks": false, "skip_nodes_if_on_run_start_fails": false}}